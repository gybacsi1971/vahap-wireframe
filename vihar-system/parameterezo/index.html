<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAHAP - Paraméterező Modul</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

    <!-- VAHAP Közös Stílusok -->
    <link rel="stylesheet" href="../assets/css/vihar-common.css">

    <style>
        .param-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
            height: 100%;
        }
        .param-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.5rem 1.5rem rgba(0, 0, 0, 0.15);
            border-color: var(--vahap-primary);
        }
        .param-card-icon {
            font-size: 3rem;
            color: var(--vahap-primary);
            margin-bottom: 1rem;
        }
        .param-card-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
        }
        .stat-box {
            background: linear-gradient(135deg, var(--vahap-primary) 0%, var(--vahap-primary-hover) 100%);
            color: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: center;
        }
        .stat-box h3 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        .stat-box p {
            margin: 0;
            opacity: 0.9;
        }
    </style>

    <!-- DÁP Design System - Inter betűtípus -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Fejléc -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-vahap-primary">
            <div class="container-fluid px-4">
                <span class="navbar-brand">
                    <i class="bi bi-sliders"></i> VAHAP Paraméterező Modul
                    <span class="badge bg-light text-dark ms-2">Rendszerparaméterek</span>
                </span>
                <div class="ms-auto d-flex align-items-center gap-3">
                    <span class="text-white">
                        <i class="bi bi-person-badge"></i> {{ adminUser }}
                        <span class="badge bg-light text-dark ms-1">{{ adminRole }}</span>
                    </span>
                    <a href="../index.html" class="btn btn-light btn-sm" title="Kilépés a paraméterező modulból">
                        <i class="bi bi-box-arrow-left"></i> Kilépés
                    </a>
                </div>
            </div>
        </nav>

        <!-- Tartalom -->
        <div class="container py-5">
            <!-- Oldal címsor -->
            <div class="row mb-4">
                <div class="col-md-8">
                    <h2><i class="bi bi-gear-fill"></i> Rendszerparaméterek és Workflow Konfiguráció</h2>
                    <p class="text-muted">
                        VAHAP rendszer működési paramétereinek központi kezelése.
                        A módosítások azonnal hatályba lépnek az új ügyek esetében.
                    </p>
                </div>
                <div class="col-md-4">
                    <div class="stat-box">
                        <h3>{{ totalModules }}</h3>
                        <p>Paraméter modul</p>
                    </div>
                </div>
            </div>

            <!-- Paraméter modulok -->
            <div class="row g-4 mb-5">
                <!-- 1. Ellenőrzési listák -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('ellenorzesi-listak.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-list-check param-card-icon"></i>
                                <h5 class="card-title">Ellenőrzési Listák</h5>
                                <p class="card-text text-muted">
                                    Hatáskör, formai és tartalmi ellenőrzési kritériumok kezelése
                                </p>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="badge bg-secondary me-1">F-0064</span>
                                    <span class="badge bg-secondary me-1">F-0065</span>
                                    <span class="badge bg-secondary">F-0066</span>
                                </div>
                                <div class="text-end small">
                                    <div class="text-muted">{{ statisztikak.ellenorzesi_listak.aktiv }}/{{ statisztikak.ellenorzesi_listak.osszes }} aktív</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. Határidők -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('hataridok.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-calendar-event param-card-icon"></i>
                                <h5 class="card-title">Határidők</h5>
                                <p class="card-text text-muted">
                                    Eljárási határidők beállítása ügytípusonként
                                </p>
                            </div>
                            <hr>
                            <div class="text-muted small">
                                <div class="d-flex justify-content-between mb-1">
                                    <span>Sommás eljárás:</span>
                                    <strong>8 nap</strong>
                                </div>
                                <div class="d-flex justify-content-between mb-1">
                                    <span>Teljes eljárás:</span>
                                    <strong>30 nap</strong>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span>Hiánypótlás:</span>
                                    <strong>15 nap</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. Díjtételek -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('dijtetelek.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-cash-stack param-card-icon"></i>
                                <h5 class="card-title">Díjtételek</h5>
                                <p class="card-text text-muted">
                                    Eljárási díjak és díjkalkulátor paraméterek
                                </p>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="badge bg-secondary">F-0070</span>
                                    <span class="badge bg-info ms-1">F-0082</span>
                                </div>
                                <i class="bi bi-arrow-right-circle fs-5 text-vahap-primary"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 4. Dokumentum sablonok -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('dokumentum-sablonok.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-file-earmark-text param-card-icon"></i>
                                <h5 class="card-title">Dokumentum Sablonok</h5>
                                <p class="card-text text-muted">
                                    Határozatok, végzések, értesítések sablonjai
                                </p>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="badge bg-secondary me-1">F-0091</span>
                                    <span class="badge bg-secondary me-1">F-0092</span>
                                    <span class="badge bg-secondary me-1">F-0093</span>
                                    <span class="badge bg-secondary">F-0094</span>
                                </div>
                                <div class="text-end small">
                                    <div class="text-muted">{{ statisztikak.dokumentum_sablonok.aktiv }}/{{ statisztikak.dokumentum_sablonok.osszes }} aktív</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 5. Workflow sablonok -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('workflow-sablonok.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-diagram-3 param-card-icon"></i>
                                <h5 class="card-title">Workflow Sablonok</h5>
                                <p class="card-text text-muted">
                                    Fő eljárási folyamatok
                                </p>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="badge bg-secondary">F-0088</span>
                                </div>
                                <div class="text-end small">
                                    <div class="text-muted">{{ statisztikak.workflow_sablonok.aktiv }}/{{ statisztikak.workflow_sablonok.osszes }} sablon</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 6. Alfolyamatok (Subprocesses) -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('alfolyamatok.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-diagram-2 param-card-icon"></i>
                                <h5 class="card-title">Alfolyamatok</h5>
                                <p class="card-text text-muted">
                                    Workflow elágazások, hiánypótlás, tényállás tisztázás
                                </p>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="badge bg-secondary me-1">F-0100</span>
                                    <span class="badge bg-secondary me-1">F-0102</span>
                                    <span class="badge bg-secondary">F-0105</span>
                                </div>
                                <div class="text-end small">
                                    <div class="text-muted">{{ statisztikak.alfolyamatok.aktiv }}/{{ statisztikak.alfolyamatok.osszes }} alfolyamat</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 6. Nyilvántartási interfészek -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('nyilvantartasok.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-database param-card-icon"></i>
                                <h5 class="card-title">Nyilvántartások</h5>
                                <p class="card-text text-muted">
                                    VNY024, HNY501 és egyéb nyilvántartási kapcsolatok
                                </p>
                            </div>
                            <hr>
                            <div class="text-muted small">
                                <div class="mb-1">
                                    <span class="badge bg-secondary me-1">F-0090</span> VNY024 Vasútegészségügy
                                </div>
                                <div>
                                    <span class="badge bg-secondary me-1">F-0106</span> HNY501 Hajózási létesítmények
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 7. Felhasználók -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('felhasznalok.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-people param-card-icon"></i>
                                <h5 class="card-title">Felhasználók</h5>
                                <p class="card-text text-muted">
                                    Felhasználók kezelése és jogosultságok
                                </p>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="text-muted small">
                                    Ügyintézők, döntéshozók
                                </div>
                                <div class="text-end small">
                                    <div class="text-muted">{{ statisztikak.felhasznalok.aktiv }}/{{ statisztikak.felhasznalok.osszes }} aktív</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 8. Szerepkörök -->
                <div class="col-md-6 col-lg-4">
                    <div class="card param-card" @click="navigateTo('szerepkorok.html')">
                        <div class="card-body position-relative">
                            <span class="param-card-badge badge bg-success">Komponens</span>
                            <div class="text-center">
                                <i class="bi bi-shield-check param-card-icon"></i>
                                <h5 class="card-title">Szerepkörök</h5>
                                <p class="card-text text-muted">
                                    Szerepkörök és jogosultsági mátrix
                                </p>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="text-muted small">
                                    VHF_ADMIN, VHF_UGYINTEZO...
                                </div>
                                <div class="text-end small">
                                    <div class="text-muted">{{ statisztikak.szerepkorok.osszes }} szerepkör</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Információs szekció -->
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h6 class="mb-0"><i class="bi bi-info-circle"></i> Paraméterezési Útmutató</h6>
                        </div>
                        <div class="card-body">
                            <ul class="mb-0">
                                <li>A <strong>kék „Aktív"</strong> badge jelöli a már elérhető paraméter modulokat</li>
                                <li>A <strong>sárga „Hamarosan"</strong> badge jelöli a fejlesztés alatt lévő modulokat</li>
                                <li>Kattintson egy kártyára a paraméterezési felület megnyitásához</li>
                                <li>A módosítások LocalStorage-ben kerülnek mentésre (mock)</li>
                                <li>Valós rendszerben API végpontokon keresztül történik a mentés</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-warning text-dark">
                            <h6 class="mb-0"><i class="bi bi-exclamation-triangle"></i> Fontos Figyelmeztetések</h6>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-warning mb-2">
                                <strong>Hatókör:</strong> A paraméter módosítások csak az új ügyekre vonatkoznak.
                            </div>
                            <div class="alert alert-danger mb-0">
                                <strong>Jogosultság:</strong> Paraméterezési jogosultság csak rendszergazdák számára elérhető.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal - Hamarosan elérhető funkciók -->
        <div class="modal fade" id="comingSoonModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="bi bi-clock-history"></i> Hamarosan elérhető
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <p class="mb-0">
                            <strong>{{ modalTitle }}</strong> paraméterezési modul jelenleg fejlesztés alatt áll.
                        </p>
                        <p class="mt-3 text-muted small mb-0">
                            Ez egy drótváz prototípus. A teljes funkcionalitás a következő fejlesztési iterációban kerül implementálásra.
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Bezárás</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- VAHAP Központi Fájlok -->
    <script src="../assets/js/vihar-config.js"></script>
    <script src="../assets/js/vihar-common.js"></script>
    <script src="../assets/js/vihar-mock-data.js"></script>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    adminUser: 'Rendszergazda',
                    adminRole: 'VAHAP_ADMIN',
                    totalModules: 8,
                    modalTitle: '',
                    modalInstance: null,
                    statisztikak: {
                        ellenorzesi_listak: { osszes: 0, aktiv: 0 },
                        hataridok: { ugytipusok: 2, konfiguralva: true },
                        dokumentum_sablonok: { osszes: 0, aktiv: 0 },
                        workflow_sablonok: { osszes: 0, aktiv: 0 },
                        alfolyamatok: { osszes: 0, aktiv: 0 },
                        felhasznalok: { osszes: 0, aktiv: 0 },
                        szerepkorok: { osszes: 0 }
                    }
                };
            },

            methods: {
                navigateTo(url) {
                    window.location.href = url;
                },

                toggleModal(moduleName) {
                    const titles = {
                        hataridok: 'Határidők',
                        dijak: 'Díjtételek',
                        dokumentumok: 'Dokumentum Sablonok',
                        dontesi: 'Döntési Opciók',
                        nyilvantartas: 'Nyilvántartási Interfészek'
                    };

                    this.modalTitle = titles[moduleName] || 'Paraméter modul';

                    if (!this.modalInstance) {
                        this.modalInstance = new bootstrap.Modal(document.getElementById('comingSoonModal'));
                    }

                    this.modalInstance.show();
                },

                loadStatisztikak() {
                    if (!VIHARMockData.parameterezo) return;

                    const param = VIHARMockData.parameterezo;

                    // Ellenőrzési listák
                    if (param.ellenorzesi_lista_hatáskor) {
                        const hataskori = param.ellenorzesi_lista_hatáskor.kriteriumok || [];
                        this.statisztikak.ellenorzesi_listak.osszes = hataskori.length;
                        this.statisztikak.ellenorzesi_listak.aktiv = hataskori.filter(k => k.aktiv).length;
                    }

                    // Dokumentum sablonok
                    if (param.dokumentum_sablonok) {
                        const sablonok = Object.values(param.dokumentum_sablonok).flat();
                        this.statisztikak.dokumentum_sablonok.osszes = sablonok.length;
                        this.statisztikak.dokumentum_sablonok.aktiv = sablonok.filter(s => s.aktiv).length;
                    }

                    // Workflow sablonok
                    if (param.workflow_sablonok) {
                        const workflows = Object.values(param.workflow_sablonok);
                        this.statisztikak.workflow_sablonok.osszes = workflows.length;
                        this.statisztikak.workflow_sablonok.aktiv = workflows.filter(w => w.aktiv).length;
                    }

                    // Alfolyamatok
                    if (param.alfolyamatok) {
                        this.statisztikak.alfolyamatok.osszes = param.alfolyamatok.length;
                        this.statisztikak.alfolyamatok.aktiv = param.alfolyamatok.filter(a => a.aktiv).length;
                    }

                    // Felhasználók
                    if (param.felhasznalok) {
                        this.statisztikak.felhasznalok.osszes = param.felhasznalok.length;
                        this.statisztikak.felhasznalok.aktiv = param.felhasznalok.filter(f => f.aktiv).length;
                    }

                    // Szerepkörök
                    if (param.szerepkorok) {
                        this.statisztikak.szerepkorok.osszes = param.szerepkorok.length;
                    }
                }
            },

            mounted() {
                console.log('[VAHAP Paraméterező] Főoldal betöltve');
                console.log('[VAHAP] Elérhető paraméter modulok:', this.totalModules);
                this.loadStatisztikak();
            }
        }).mount('#app');
    </script>
</body>
</html>
